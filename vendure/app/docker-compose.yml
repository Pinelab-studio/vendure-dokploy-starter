services:

    # RECOMMENDED (especially for production)
    # Want to use our BullMQ with Redis instead of our default database job queue?
    # Checkout our BullMQ plugin: https://docs.vendure.io/reference/core-plugins/job-queue-plugin/bull-mqjob-queue-plugin/
    redis:
        image: redis:7-alpine
        ports:
            - "6479:6379"
        volumes:
            - redis_data:/data
        labels:
            - "io.vendure.create.name=app"

    # RECOMMENDED
    # Want to use Typesense instead of our default search engine?
    # Checkout our advanced search plugin: https://vendure.io/hub/vendure-plus-advanced-search-plugin
    # To run the typesense container run "docker compose up -d typesense"
    typesense:
        image: typesense/typesense:27.0
        command: [ '--data-dir', '/data', '--api-key', 'SuperSecret' ]
        ports:
            - "8208:8108"
        volumes:
            - typesense_data:/data
        labels:
            - "io.vendure.create.name=app"

    # Want to use Elasticsearch instead of our default database engine?
    # Checkout our Elasticsearch plugin: https://docs.vendure.io/reference/core-plugins/elasticsearch-plugin/
    # To run the elasticsearch container run "docker compose up -d elasticsearch"
    elasticsearch:
        image: docker.elastic.co/elasticsearch/elasticsearch:7.1.1
        environment:
            discovery.type: single-node
            bootstrap.memory_lock: true
            ES_JAVA_OPTS: -Xms512m -Xmx512m
        volumes:
            - elasticsearch_data:/usr/share/elasticsearch/data
        ports:
            - "9300:9200"
        labels:
            - "io.vendure.create.name=app"

volumes:
    postgres_db_data:
        driver: local
        labels:
            - "io.vendure.create.name=app"
    mysql_db_data:
        driver: local
        labels:
            - "io.vendure.create.name=app"
    mariadb_db_data:
        driver: local
        labels:
            - "io.vendure.create.name=app"
    typesense_data:
        driver: local
        labels:
            - "io.vendure.create.name=app"
    elasticsearch_data:
        driver: local
        labels:
            - "io.vendure.create.name=app"
    redis_data:
        driver: local
        labels:
            - "io.vendure.create.name=app"
